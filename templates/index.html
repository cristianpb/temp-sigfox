<html>
  <head>
    <title>Temperature Sigfox</title>
    <meta charset="utf-8" name="viewport" content= "width=device-width, initial-scale=1.0"> 
    <style>
      .title { 
      font-size:40px; 
      font-weight:bold; 
      text-align:center; 
      } 
    </style>
  </head>
  <body>
    <h1 class="title">Temperature Sigfox</h1>

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.13.0/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.6.0/Chart.js" type="text/javascript"></script>

    <canvas id="myChart"></canvas>
    <script>
        var ctx = document.getElementById('myChart').getContext('2d');
        function update_progress() {
            // send GET request to status URL
            $.getJSON("/data", function(data) {
                // update UI
                var chart = new Chart(ctx, {
                  // The type of chart we want to create
                  type: 'line',

                  // The data for our dataset
                  data: {
                    datasets: [{
                      label: 'Temperature',
                      borderColor: 'rgb(255, 99, 132)',
                      backgroundColor: 'rgb(255, 99, 132)',
                      fill: false,
                      yAxisID: 'temp-y-axis',
                      data: data.map((item) => {
                        return {x: moment.unix(item.seconds), y: Number(item.temperature)}

                      })
                    },{
                      label: 'Humidity',
                      borderColor: 'rgb(132, 188, 188)',
                      backgroundColor: 'rgb(132, 188, 188)',
                      fill: false,
                      yAxisID: 'hum-y-axis',
                      data: data.map((item) => {
                        return {x: moment.unix(item.seconds), y: Number(item.humidity)}

                      })
                    },
                    ]
                  },

                  // Configuration options go here
                  options: {
                    scales: {
                      xAxes: [{
                        type: 'time',
                      }],
                      yAxes: [{
                        id: 'temp-y-axis',
                        type: 'linear',
                        position: 'left',
                        scaleLabel: {
                          display: true,
                          labelString: 'Temperature'
                        }
                      }, {
                        id: 'hum-y-axis',
                        type: 'linear',
                        position: 'right',
                        scaleLabel: {
                          display: true,
                          labelString: 'Humidity'
                        }
                      }]
                    },
                    tooltips: {
                      mode: 'nearest',
                      intersect: false,
                      callbacks: {
                        title: function(tooltipItems, data) {
                          return tooltipItems[0].xLabel.format("h:mma, D MMM YY");
                        }
                      }
                    }

                  }
                });



            });
        }
        update_progress();
    </script>
  </body>
</html>
